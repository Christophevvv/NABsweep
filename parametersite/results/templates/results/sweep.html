{% extends "results/base.html" %}
{% load static %}

{% block content %}
<h1>Sweep with id {{ sweep_id }}</h1>

<table name="sortableTable" class="table table-striped table-bordered table-sm" cellspacing="0" width="100%">
  <thead>
    <tr>
      <th class="th-sm"> Run ID </th>
      {% for run in runs %}
      {% if forloop.first %}
      {% for runvalue in runvalues %}
      {% if runvalue.run.id == run.id %}
      <th class="th-sm"> {{ runvalue.sweep_parameter.parameter }} </th>
      {% endif %}
      {% endfor %}
    </tr>
  </thead>
  <tbody>    
    {% endif %}
    <tr>
      <td>
	<a href="{% url 'results:run' run.id %}">
	  {{ run.id }}
	</a>
      </td>    
      {% for runvalue in runvalues %}
      {% if runvalue.run.id == run.id %}
      <td>
	{{ runvalue.value }}
      </td>
      {% endif %}
      {% endfor %}
    </tr>
    {% endfor %}
  </tbody>
</table>
{% for profile in profiles %}
<canvas id="{{profile.name}}_chart" style="max-width: 500px;"></canvas>
{% endfor %}
{% endblock %}

{% block scripts %}
<!-- MDBootstrap Datatables  -->
<script type="text/javascript" src="{% static 'results/js/addons/datatables.min.js' %}"></script>
<script type="text/javascript">
  $(document).ready(function () {
      $('[name=sortableTable]').DataTable();
      $('.dataTables_length').addClass('bs-select');
  });
</script> 
<script>
  {% for profile in profiles %}  
  var {{profile.name}}_ctx = document.getElementById("{{profile.name}}_chart").getContext('2d');
  var {{profile.name}}_chart = new Chart({{profile.name}}_ctx, {
    type: 'line',
    data: {
	labels: {{ x }},
      datasets: [{
          label: 'Normalized score',
	  {% for key,val in y.items %}
	  {% if key == profile.name %}
          data: {{ val }},
	  {% endif %}
	  {% endfor %}
          borderWidth: 1,
        },
	{
	    label: 'baseline',
	    {% for key,val in baseline_scores.items %}
	    {% if key == profile.name %}
	    data : {{ val }},
	    {% endif %}
	    {% endfor %}	    
	    backgroundColor: [
		'rgba(0, 137, 132, 0)',
            ],
            borderColor: [
		'rgba(0, 0, 0, 1)',
            ],
	    borderWidth: 1,
	    pointRadius: 0,
	    pointHitRadius: 0
      }]
    },
    options: {
      scales: {
        yAxes: [{
          ticks: {
            beginAtZero: false
          }
        }]
      }
    }
  });
  {% endfor %}

</script>

{% endblock %}

{% block css %}
<!-- MDBootstrap Datatables  -->
<link href="{% static 'results/css/addons/datatables.min.css' %}" rel="stylesheet">
{% endblock %}
